# Техническое задание: Telegram-бот для коллективного сбора и разметки голосовых данных

## 1. Общее описание
Telegram-бот предназначен для организации коллективного сбора и разметки голосовых команд. Система позволяет пользователям записывать голосовые команды и оценивать записи других участников, получая за это баллы.

## 2. Функциональные требования

### 2.1. Регистрация и авторизация
- Регистрация пользователей через Telegram
- Сбор информации при регистрации:
  - Имя пользователя
  - Контактная информация (опционально)
  - Электронная почта (опционально)
  - Организация/учебное заведение
- Создание профиля с системой баллов

### 2.2. Запись голосовых команд
- Получение текстовых команд от системы
- Возможность записи нескольких вариантов произношения
- Автоматическая проверка соответствия записи и текста команды
- Ежедневный лимит: 10 команд на пользователя
- Начисление баллов за принятые записи

### 2.3. Оценка записей
- Прослушивание записей других пользователей
- Система оценки через три кнопки:
  - "Подходит" (+1 балл автору записи)
  - "Есть неточности" (0 баллов)
  - "Не подходит" (-1 балл)
- Ежедневный лимит: 10 записей на проверку

### 2.4. Система баллов
- Начисление баллов за:
  - Принятые голосовые записи
  - Получение положительных оценок от других пользователей
- Списание баллов за негативные оценки
- Отображение текущего баланса в профиле

## 3. Технические требования

### 3.1. Технологический стек
- Python 3.8+
- aiogram (для работы с Telegram API)
- SQLite (система управления базами данных)
- speech_recognition (для распознавания речи)

### 3.2. База данных
Структура таблиц SQLite:

sql
-- Пользователи
CREATE TABLE users (
user_id INTEGER PRIMARY KEY,
telegram_id INTEGER UNIQUE,
username TEXT,
email TEXT,
organization TEXT,
points INTEGER DEFAULT 0,
registration_date TIMESTAMP
);
-- Голосовые записи
CREATE TABLE voice_records (
record_id INTEGER PRIMARY KEY,
user_id INTEGER,
command_text TEXT,
file_path TEXT,
status TEXT,
created_at TIMESTAMP,
FOREIGN KEY (user_id) REFERENCES users(user_id)
);
-- Оценки записей
CREATE TABLE ratings (
rating_id INTEGER PRIMARY KEY,
record_id INTEGER,
rater_id INTEGER,
rating TEXT,
rated_at TIMESTAMP,
FOREIGN KEY (record_id) REFERENCES voice_records(record_id),
FOREIGN KEY (rater_id) REFERENCES users(user_id)
);
-- Команды для записи
CREATE TABLE commands (
command_id INTEGER PRIMARY KEY,
command_text TEXT,
description TEXT,
active BOOLEAN
);

### 3.3. Архитектура системы
plaintext
[Telegram] <-> [Bot Server (aiogram)] <-> [Database (SQLite)]
|
v
[Speech Recognition]

## 4. Роли пользователей

### 4.1. Обычный пользователь
- Запись голосовых команд
- Оценка записей других пользователей
- Просмотр своего баланса и статистики

### 4.2. Администратор
- Управление списком команд
- Просмотр статистики системы
- Модерация пользователей
- Экспорт данных

## 5. Требования к развертыванию
- Единый сервер для работы бота
- Операционная система: Linux
- Доступ к Telegram API
- Достаточно места для хранения аудиофайлов
- Резервное копирование базы данных

## 6. Безопасность
- Валидация входных данных
- Ограничение доступа к административным функциям
- Защита от спама и флуда
- Регулярное резервное копирование данных

## 7. Масштабируемость
- Возможность увеличения количества пользователей
- Оптимизация хранения аудиофайлов
- Система очереди для обработки записей